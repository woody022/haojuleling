<!-- pages/utils-demo/index.wxml -->
<view class="container">
  <!-- 页头 -->
  <view class="header">
    <view class="title">工具类功能测试</view>
    <view class="subtitle">点击下方按钮测试对应功能</view>
  </view>

  <!-- 测试按钮区域 -->
  <view class="section">
    <view class="section-title">基础功能测试</view>
    <view class="button-group">
      <button class="button" bindtap="testIsEmpty">测试isEmpty</button>
      <button class="button" bindtap="testDeepClone">测试deepClone</button>
      <button class="button" bindtap="testMerge">测试merge</button>
      <button class="button" bindtap="testFormatDate">测试日期格式化</button>
      <button class="button" bindtap="testFormatNumber">测试数字格式化</button>
      <button class="button" bindtap="testRandom">测试随机数</button>
      <button class="button" bindtap="testGetUrlParam">测试URL参数解析</button>
      <button class="button" bindtap="testBuildUrlParams">测试URL参数构建</button>
      <button class="button" bindtap="testRandomString">测试随机字符串</button>
      <button class="button" bindtap="testFormatFileSize">测试文件大小格式化</button>
      <button class="button" bindtap="testTreeOperations">测试树结构操作</button>
    </view>
  </view>

  <!-- 防抖与节流功能测试 -->
  <view class="section">
    <view class="section-title">防抖与节流测试</view>
    <view class="function-row">
      <view class="function-item">
        <view class="function-label">防抖函数</view>
        <view class="function-value">计数：{{debounceCount}}</view>
        <button class="button" bindtap="handleDebounceClick">点击测试(500ms)</button>
      </view>
      <view class="function-item">
        <view class="function-label">节流函数</view>
        <view class="function-value">计数：{{throttleCount}}</view>
        <button class="button" bindtap="handleThrottleClick">点击测试(500ms)</button>
      </view>
    </view>
  </view>

  <!-- 表单验证测试 -->
  <view class="section">
    <view class="section-title">表单验证测试</view>
    <view class="form">
      <view class="form-item">
        <view class="form-label">用户名</view>
        <input class="form-input {{formErrors.username ? 'input-error' : ''}}" 
               placeholder="请输入用户名" 
               data-field="username" 
               bindinput="handleInput"
               value="{{formData.username}}" />
        <view class="error-text" wx:if="{{formErrors.username}}">{{formErrors.username}}</view>
      </view>
      
      <view class="form-item">
        <view class="form-label">邮箱</view>
        <input class="form-input {{formErrors.email ? 'input-error' : ''}}" 
               placeholder="请输入邮箱" 
               data-field="email" 
               bindinput="handleInput"
               value="{{formData.email}}" />
        <view class="error-text" wx:if="{{formErrors.email}}">{{formErrors.email}}</view>
      </view>
      
      <view class="form-item">
        <view class="form-label">手机号</view>
        <input class="form-input {{formErrors.phone ? 'input-error' : ''}}" 
               placeholder="请输入手机号" 
               data-field="phone" 
               bindinput="handleInput"
               value="{{formData.phone}}" />
        <view class="error-text" wx:if="{{formErrors.phone}}">{{formErrors.phone}}</view>
      </view>
      
      <view class="form-item">
        <view class="form-label">年龄</view>
        <input class="form-input {{formErrors.age ? 'input-error' : ''}}" 
               placeholder="请输入年龄" 
               type="number"
               data-field="age" 
               bindinput="handleInput"
               value="{{formData.age}}" />
        <view class="error-text" wx:if="{{formErrors.age}}">{{formErrors.age}}</view>
      </view>
      
      <button class="button submit-button" bindtap="submitForm">提交表单</button>
      
      <view class="network-result" wx:if="{{networkResult}}">{{networkResult}}</view>
    </view>
  </view>

  <!-- 结果显示区域 -->
  <view class="section">
    <view class="section-header">
      <view class="section-title">测试结果</view>
      <view class="clear-button" bindtap="clearResults">清空结果</view>
    </view>
    
    <scroll-view class="results-container" scroll-y>
      <block wx:if="{{results.length === 0}}">
        <view class="empty-result">尚未进行测试</view>
      </block>
      <block wx:else>
        <view class="result-item" wx:for="{{results}}" wx:key="index">
          <view class="result-title">{{item.title}}</view>
          <view class="result-content">{{item.result}}</view>
        </view>
      </block>
    </scroll-view>
  </view>
</view>