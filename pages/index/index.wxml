<!-- 读者艺术小程序首页 index.wxml -->
<view class="reader-art-container">
  <!-- 顶部用户信息区 -->
  <view class="user-info-area">
    <view class="user-info">
      <view class="avatar"></view>
      <view class="user-text">
        <text class="welcome-text">{{isLogin ? '欢迎回来' : '未登录'}}</text>
        <text class="profile-link">{{isLogin ? userInfo.nickName || '点击查看个人主页' : '点击登录'}}</text>
      </view>
    </view>
    <view class="message-btn" bindtap="navigateToMessages">
      <text>消息</text>
      <view class="message-dot" wx:if="{{unreadCount > 0}}"></view>
    </view>
  </view>

  <!-- 顶部背景区域 -->
  <view class="banner-bg">
    <swiper class="banner-swiper" 
      indicator-dots="{{false}}"
      autoplay="{{true}}" 
      interval="{{3000}}" 
      duration="{{500}}"
      circular="{{true}}"
      previous-margin="20rpx"
      next-margin="20rpx"
      current="{{currentBannerIndex}}"
      bindchange="onBannerChange">
      <block wx:for="{{bannerList}}" wx:key="id">
        <swiper-item bind:tap="onBannerTap" data-id="{{item.id}}">
          <view class="banner-item" style="background: {{item.gradientColor}}">
            <!-- 左侧内容区域 -->
            <view class="banner-info">
              <view class="banner-category">{{item.category}}</view>
              <view class="banner-title">{{item.title}}</view>
              <view class="banner-price">{{item.price}}</view>
            </view>
            <!-- 右侧图片区域 -->
            <view class="banner-image-container">
              <view class="banner-image-wrapper">
                <image class="banner-image" src="{{item.imageUrl}}" mode="aspectFill"></image>
              </view>
              <!-- 图片下方的滑块指示器 -->
              <view class="banner-image-slider">
                <block wx:for="{{bannerList}}" wx:for-item="sliderItem" wx:for-index="sliderIndex" wx:key="id">
                  <view class="slider-dot {{currentBannerIndex === sliderIndex ? 'active' : ''}}"></view>
                </block>
              </view>
            </view>
          </view>
        </swiper-item>
      </block>
    </swiper>
  </view>

  <!-- 功能导航栏 -->
  <view class="nav-bar">
    <view class="nav-item" bindtap="switchNavType" data-type="hot">
      <text>最新</text>
    </view>
    <view class="nav-item" bindtap="switchNavType" data-type="recommend">
      <text>推荐</text>
    </view>
    <view class="nav-item" bindtap="switchNavType" data-type="nearby">
      <text>附近</text>
    </view>
    <view class="nav-item" bindtap="switchNavType" data-type="soon">
      <text>即将开始</text>
    </view>
  </view>

  <!-- 分隔线 -->
  <view class="divider"></view>

  <!-- 热门活动区 -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">热门活动</text>
      <text class="view-more" bindtap="viewMoreActivities" data-type="hot">查看更多</text>
    </view>
    
    <scroll-view class="activity-list" scroll-x="true" enable-flex="true">
      <block wx:for="{{hotActivities}}" wx:key="id">
        <view class="activity-card" bindtap="navigateToActivityDetail" data-id="{{item.id}}">
          <view class="activity-cover {{item.coverType}}">
            <image class="activity-cover-image" src="{{item.coverUrl}}" mode="aspectFill" lazy-load="true" binderror="onImageError" data-index="hot-{{index}}"></image>
            <view class="activity-info-overlay">
              <text class="activity-title">{{item.title}}</text>
              <view class="enrollment-info">
                <text class="enrolled-text">已报名</text>
                <text class="enrolled-count">{{item.enrollCount || 0}}</text>
              </view>
            </view>
          </view>
          <view class="activity-bottom">
            <text class="organizer">{{item.organizer || '主办方'}}</text>
            <view class="tag {{item.tag === '热门' ? 'hot-tag' : (item.tag === '推荐' ? 'recommend-tag' : 'new-tag')}}">
              <text>{{item.tag}}</text>
            </view>
          </view>
        </view>
      </block>
    </scroll-view>
  </view>

  <!-- 社区活动区 -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">社区活动</text>
      <text class="view-more" bindtap="viewMoreActivities" data-type="community">查看更多</text>
    </view>
    
    <scroll-view class="activity-list" scroll-x="true" enable-flex="true">
      <block wx:for="{{communityActivities}}" wx:key="id">
        <view class="activity-card" bindtap="navigateToActivityDetail" data-id="{{item.id}}">
          <view class="activity-cover {{item.coverType}}">
            <image class="activity-cover-image" src="{{item.coverUrl}}" mode="aspectFill" lazy-load="true" binderror="onImageError" data-index="community-{{index}}"></image>
            <view class="activity-info-overlay">
              <text class="activity-title">{{item.title}}</text>
              <view class="enrollment-info">
                <text class="enrolled-text">已报名</text>
                <text class="enrolled-count">{{item.enrollCount || 0}}</text>
              </view>
            </view>
          </view>
          <view class="activity-bottom">
            <text class="organizer">{{item.organizer || '主办方'}}</text>
            <view class="tag {{item.tag === '热门' ? 'hot-tag' : (item.tag === '推荐' ? 'recommend-tag' : 'new-tag')}}">
              <text>{{item.tag}}</text>
            </view>
          </view>
        </view>
      </block>
    </scroll-view>
  </view>

  <!-- 底部导航栏 -->
  <view class="tab-bar">
    <view class="tab-item tab-active">
      <text>首页</text>
      <view class="active-indicator"></view>
    </view>
    <view class="tab-item" bindtap="switchTab" data-index="1">
      <text>活动</text>
    </view>
    <view class="tab-item tab-center" bindtap="showPublishOptions">
      <view class="plus-btn"></view>
    </view>
    <view class="tab-item" bindtap="switchTab" data-index="3">
      <text>社区</text>
    </view>
    <view class="tab-item" bindtap="switchTab" data-index="4">
      <text>我的</text>
    </view>
  </view>
</view>