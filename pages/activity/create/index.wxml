<!-- pages/activity/create/index.wxml -->
<view class="activity-create-container">
  <view class="header">
    <text class="title">{{isEdit ? '编辑活动' : '创建活动'}}</text>
    <text class="description">填写活动信息，让更多人了解你的活动</text>
  </view>
  
  <form bindsubmit="submitForm">
    <!-- 基本信息部分 -->
    <view class="section">
      <view class="section-title">基本信息</view>
      
      <view class="form-item">
        <text class="label required">活动标题</text>
        <view class="input-container">
          <input class="input" value="{{title}}" bindinput="onTitleInput" placeholder="请输入活动标题" maxlength="50" />
          <view class="error-text" wx:if="{{errors.title}}">{{errors.title}}</view>
        </view>
      </view>
      
      <view class="form-item">
        <text class="label required">活动类型</text>
        <view class="input-container">
          <picker class="picker" mode="selector" range="{{typeOptions}}" value="{{typeIndex}}" bindchange="onTypeChange">
            <view class="picker-content">
              <text wx:if="{{type}}">{{type}}</text>
              <text wx:else class="placeholder">请选择活动类型</text>
              <text class="picker-arrow">></text>
            </view>
          </picker>
          <view class="error-text" wx:if="{{errors.type}}">{{errors.type}}</view>
        </view>
      </view>
      
      <view class="form-item">
        <text class="label">活动描述</text>
        <view class="input-container">
          <textarea class="textarea" value="{{description}}" bindinput="onDescriptionInput" placeholder="请输入活动描述" maxlength="{{maxDescriptionLength}}" />
          <view class="textarea-counter">{{descriptionCount}}/{{maxDescriptionLength}}</view>
        </view>
      </view>
    </view>
    
    <!-- 时间地点部分 -->
    <view class="section">
      <view class="section-title">时间地点</view>
      
      <view class="form-item">
        <text class="label required">活动地点</text>
        <view class="input-container">
          <view class="location-input">
            <input class="input" value="{{address}}" bindinput="onAddressInput" placeholder="请输入活动地点" />
            <button class="location-btn" bindtap="chooseLocation">定位</button>
          </view>
          <view class="error-text" wx:if="{{errors.address}}">{{errors.address}}</view>
        </view>
      </view>
      
      <view class="form-item">
        <text class="label required">开始时间</text>
        <view class="input-container">
          <view class="date-picker" bindtap="showDatePicker" data-type="start">
            <text>{{startDate}} {{startTime}}</text>
            <text class="picker-arrow">></text>
          </view>
          <view class="error-text" wx:if="{{errors.startTime}}">{{errors.startTime}}</view>
        </view>
      </view>
      
      <view class="form-item">
        <text class="label required">结束时间</text>
        <view class="input-container">
          <view class="date-picker" bindtap="showDatePicker" data-type="end">
            <text>{{endDate}} {{endTime}}</text>
            <text class="picker-arrow">></text>
          </view>
          <view class="error-text" wx:if="{{errors.endTime}}">{{errors.endTime}}</view>
        </view>
      </view>
      
      <view class="form-item">
        <text class="label">人数限制</text>
        <view class="input-container">
          <input class="input" type="number" value="{{maxParticipants}}" bindinput="onMaxParticipantsInput" placeholder="不填则不限制人数" />
          <view class="error-text" wx:if="{{errors.maxParticipants}}">{{errors.maxParticipants}}</view>
        </view>
      </view>
    </view>
    
    <!-- 标签部分 -->
    <view class="section">
      <view class="section-title">活动标签</view>
      
      <view class="form-item">
        <text class="label">添加标签</text>
        <view class="input-container">
          <view class="tag-input-container">
            <input class="input tag-input" value="{{tagInput}}" bindinput="onTagInput" placeholder="输入标签后点击添加" />
            <button class="tag-add-btn" bindtap="addTag">添加</button>
          </view>
          
          <view class="tags-container" wx:if="{{tags.length > 0}}">
            <view class="tag-item" wx:for="{{tags}}" wx:key="index">
              <text>{{item}}</text>
              <text class="tag-remove" bindtap="removeTag" data-index="{{index}}">×</text>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- 图片部分 -->
    <view class="section">
      <view class="section-title">活动图片</view>
      
      <view class="form-item">
        <text class="label required">封面图片</text>
        <view class="input-container">
          <view class="image-picker-container">
            <view class="cover-image-container" wx:if="{{coverImage}}" bindtap="chooseCoverImage">
              <image class="cover-image" src="{{coverImage}}" mode="aspectFill"></image>
              <view class="image-remove" catchtap="removeCoverImage">×</view>
            </view>
            <view class="image-picker" wx:else bindtap="chooseCoverImage">
              <text class="image-picker-icon">+</text>
              <text class="image-picker-text">上传封面</text>
            </view>
          </view>
          <view class="error-text" wx:if="{{errors.coverImage}}">{{errors.coverImage}}</view>
        </view>
      </view>
      
      <view class="form-item">
        <text class="label">活动图片</text>
        <view class="input-container">
          <view class="image-list">
            <view class="image-item" wx:for="{{activityImages}}" wx:key="index">
              <image class="activity-image" src="{{item}}" mode="aspectFill"></image>
              <view class="image-remove" catchtap="removeImage" data-index="{{index}}">×</view>
            </view>
            
            <view class="image-picker" wx:if="{{activityImages.length < 9}}" bindtap="chooseActivityImage">
              <text class="image-picker-icon">+</text>
              <text class="image-picker-text">添加图片</text>
            </view>
          </view>
          <text class="image-tip">最多上传9张活动图片</text>
        </view>
      </view>
    </view>
    
    <!-- 设置部分 -->
    <view class="section">
      <view class="section-title">活动设置</view>
      
      <view class="form-item">
        <text class="label">公开活动</text>
        <view class="input-container">
          <switch checked="{{isPublic}}" bindchange="togglePublic" color="#3cc51f" />
          <text class="switch-text">{{isPublic ? '所有人可见' : '仅邀请可见'}}</text>
        </view>
      </view>
    </view>
    
    <!-- 提交按钮 -->
    <view class="submit-container">
      <button class="submit-btn" form-type="submit" loading="{{isSubmitting}}" disabled="{{isSubmitting}}">
        {{isEdit ? '保存修改' : '创建活动'}}
      </button>
    </view>
  </form>
</view>

<!-- 日期时间选择器弹窗 -->
<view class="date-picker-modal" wx:if="{{showDatePicker}}">
  <view class="date-picker-mask" bindtap="closeDatePicker"></view>
  <view class="date-picker-content">
    <view class="date-picker-header">
      <text class="date-picker-title">选择{{datePickerType === 'start' ? '开始' : '结束'}}时间</text>
      <text class="date-picker-close" bindtap="closeDatePicker">×</text>
    </view>
    
    <picker-view class="picker-view" value="{{datePickerValue}}" bindchange="onDatePickerChange">
      <!-- 日期时间选择器内容 -->
      <!-- 注意：这里简化处理，实际项目中需要完整实现日期时间选择器 -->
      <picker-view-column>
        <!-- 年份列 -->
      </picker-view-column>
      <picker-view-column>
        <!-- 月份列 -->
      </picker-view-column>
      <picker-view-column>
        <!-- 日期列 -->
      </picker-view-column>
      <picker-view-column>
        <!-- 小时列 -->
      </picker-view-column>
      <picker-view-column>
        <!-- 分钟列 -->
      </picker-view-column>
    </picker-view>
    
    <view class="date-picker-footer">
      <button class="cancel-btn" bindtap="closeDatePicker">取消</button>
      <button class="confirm-btn" bindtap="confirmDatePicker">确定</button>
    </view>
  </view>
</view>